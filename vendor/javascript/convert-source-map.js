import e from"buffer";var t={};var r=e.Buffer;Object.defineProperty(t,"commentRegex",{get:function getCommentRegex(){return/^\s*?\/[\/\*][@#]\s+?sourceMappingURL=data:(((?:application|text)\/json)(?:;charset=([^;,]+?)?)?)?(?:;(base64))?,(.*?)$/gm}});Object.defineProperty(t,"mapFileCommentRegex",{get:function getMapFileCommentRegex(){return/(?:\/\/[@#][ \t]+?sourceMappingURL=([^\s'"`]+?)[ \t]*?$)|(?:\/\*[@#][ \t]+sourceMappingURL=([^*]+?)[ \t]*?(?:\*\/){1}[ \t]*?$)/gm}});var o;o="undefined"!==typeof r?"function"===typeof r.from?decodeBase64WithBufferFrom:decodeBase64WithNewBuffer:decodeBase64WithAtob;function decodeBase64WithBufferFrom(e){return r.from(e,"base64").toString()}function decodeBase64WithNewBuffer(e){if("number"===typeof value)throw new TypeError("The value to decode must not be of type number.");return new r(e,"base64").toString()}function decodeBase64WithAtob(e){return decodeURIComponent(escape(atob(e)))}function stripComment(e){return e.split(",").pop()}function readFromFileMap(e,r){var o=t.mapFileCommentRegex.exec(e);var n=o[1]||o[2];try{e=r(n);return null!=e&&"function"===typeof e.catch?e.catch(throwError):e}catch(e){throwError(e)}function throwError(e){throw new Error("An error occurred while trying to read the map file at "+n+"\n"+e.stack)}}function Converter(e,t){t=t||{};t.hasComment&&(e=stripComment(e));"base64"===t.encoding?e=o(e):"uri"===t.encoding&&(e=decodeURIComponent(e));(t.isJSON||t.encoding)&&(e=JSON.parse(e));this.sourcemap=e}Converter.prototype.toJSON=function(e){return JSON.stringify(this.sourcemap,null,e)};"undefined"!==typeof r?"function"===typeof r.from?Converter.prototype.toBase64=encodeBase64WithBufferFrom:Converter.prototype.toBase64=encodeBase64WithNewBuffer:Converter.prototype.toBase64=encodeBase64WithBtoa;function encodeBase64WithBufferFrom(){var e=this.toJSON();return r.from(e,"utf8").toString("base64")}function encodeBase64WithNewBuffer(){var e=this.toJSON();if("number"===typeof e)throw new TypeError("The json to encode must not be of type number.");return new r(e,"utf8").toString("base64")}function encodeBase64WithBtoa(){var e=this.toJSON();return btoa(unescape(encodeURIComponent(e)))}Converter.prototype.toURI=function(){var e=this.toJSON();return encodeURIComponent(e)};Converter.prototype.toComment=function(e){var t,r,o;if(null!=e&&"uri"===e.encoding){t="";r=this.toURI()}else{t=";base64";r=this.toBase64()}o="sourceMappingURL=data:application/json;charset=utf-8"+t+","+r;return null!=e&&e.multiline?"/*# "+o+" */":"//# "+o};Converter.prototype.toObject=function(){return JSON.parse(this.toJSON())};Converter.prototype.addProperty=function(e,t){if(this.sourcemap.hasOwnProperty(e))throw new Error('property "'+e+'" already exists on the sourcemap, use set property instead');return this.setProperty(e,t)};Converter.prototype.setProperty=function(e,t){this.sourcemap[e]=t;return this};Converter.prototype.getProperty=function(e){return this.sourcemap[e]};t.fromObject=function(e){return new Converter(e)};t.fromJSON=function(e){return new Converter(e,{isJSON:true})};t.fromURI=function(e){return new Converter(e,{encoding:"uri"})};t.fromBase64=function(e){return new Converter(e,{encoding:"base64"})};t.fromComment=function(e){var r,o;e=e.replace(/^\/\*/g,"//").replace(/\*\/$/g,"");r=t.commentRegex.exec(e);o=r&&r[4]||"uri";return new Converter(e,{encoding:o,hasComment:true})};function makeConverter(e){return new Converter(e,{isJSON:true})}t.fromMapFileComment=function(e,t){if("string"===typeof t)throw new Error("String directory paths are no longer supported with `fromMapFileComment`\nPlease review the Upgrading documentation at https://github.com/thlorenz/convert-source-map#upgrading");var r=readFromFileMap(e,t);return null!=r&&"function"===typeof r.then?r.then(makeConverter):makeConverter(r)};t.fromSource=function(e){var r=e.match(t.commentRegex);return r?t.fromComment(r.pop()):null};t.fromMapFileSource=function(e,r){if("string"===typeof r)throw new Error("String directory paths are no longer supported with `fromMapFileSource`\nPlease review the Upgrading documentation at https://github.com/thlorenz/convert-source-map#upgrading");var o=e.match(t.mapFileCommentRegex);return o?t.fromMapFileComment(o.pop(),r):null};t.removeComments=function(e){return e.replace(t.commentRegex,"")};t.removeMapFileComments=function(e){return e.replace(t.mapFileCommentRegex,"")};t.generateMapFileComment=function(e,t){var r="sourceMappingURL="+e;return t&&t.multiline?"/*# "+r+" */":"//# "+r};const n=t.fromObject,i=t.fromJSON,a=t.fromURI,u=t.fromBase64,m=t.fromComment,p=t.fromMapFileComment,c=t.fromSource,f=t.fromMapFileSource,s=t.removeComments,h=t.removeMapFileComments,d=t.generateMapFileComment;export{t as default,u as fromBase64,m as fromComment,i as fromJSON,p as fromMapFileComment,f as fromMapFileSource,n as fromObject,c as fromSource,a as fromURI,d as generateMapFileComment,s as removeComments,h as removeMapFileComments};

