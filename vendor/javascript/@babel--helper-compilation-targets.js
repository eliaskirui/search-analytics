import*as e from"browserslist";import*as r from"@babel/helper-validator-option";import*as t from"@babel/compat-data/native-modules";import*as n from"lru-cache";import*as s from"semver";import*as o from"@babel/compat-data/plugins";import a from"process";var i={};Object.defineProperty(i,"__esModule",{value:true});i.unreleasedLabels=i.browserNameMap=void 0;i.unreleasedLabels={safari:"tp"};i.browserNameMap={and_chr:"chrome",and_ff:"firefox",android:"android",chrome:"chrome",edge:"edge",firefox:"firefox",ie:"ie",ie_mob:"ie",ios_saf:"ios",node:"node",deno:"deno",op_mob:"opera_mobile",opera:"opera",safari:"safari",samsung:"samsung"};var l=s;try{"default"in s&&(l=s.default)}catch(e){}var u=r;try{"default"in r&&(u=r.default)}catch(e){}var c={};Object.defineProperty(c,"__esModule",{value:true});c.getHighestUnreleased=getHighestUnreleased;c.getLowestImplementedVersion=getLowestImplementedVersion;c.getLowestUnreleased=getLowestUnreleased;c.isUnreleasedVersion=isUnreleasedVersion;c.semverMin=semverMin;c.semverify=semverify;var d=l;var f=u;var g=i;const m=/^(\d+|\d+.\d+)$/;const v=new f.OptionValidator("@babel/helper-compilation-targets");function semverMin(e,r){return e&&d.lt(e,r)?e:r}function semverify(e){if(typeof e==="string"&&d.valid(e))return e;v.invariant(typeof e==="number"||typeof e==="string"&&m.test(e),`'${e}' is not a valid version`);e=e.toString();let r=0;let t=0;while((r=e.indexOf(".",r+1))>0)t++;return e+".0".repeat(2-t)}function isUnreleasedVersion(e,r){const t=g.unreleasedLabels[r];return!!t&&t===e.toString().toLowerCase()}function getLowestUnreleased(e,r,t){const n=g.unreleasedLabels[t];return e===n?r:r===n?e:semverMin(e,r)}function getHighestUnreleased(e,r,t){return getLowestUnreleased(e,r,t)===e?r:e}function getLowestImplementedVersion(e,r){const t=e[r];return t||r!=="android"?t:e.chrome}var p={};Object.defineProperty(p,"__esModule",{value:true});p.TargetNames=void 0;p.TargetNames={node:"node",deno:"deno",chrome:"chrome",opera:"opera",edge:"edge",firefox:"firefox",safari:"safari",ie:"ie",ios:"ios",android:"android",electron:"electron",samsung:"samsung",rhino:"rhino",opera_mobile:"opera_mobile"};var y=s;try{"default"in s&&(y=s.default)}catch(e){}var b={};Object.defineProperty(b,"__esModule",{value:true});b.prettifyTargets=prettifyTargets$1;b.prettifyVersion=prettifyVersion;var h=y;var w=i;function prettifyVersion(e){if(typeof e!=="string")return e;const{major:r,minor:t,patch:n}=h.parse(e);const s=[r];(t||n)&&s.push(t);n&&s.push(n);return s.join(".")}function prettifyTargets$1(e){return Object.keys(e).reduce(((r,t)=>{let n=e[t];const s=w.unreleasedLabels[t];typeof n==="string"&&s!==n&&(n=prettifyVersion(n));r[t]=n;return r}),{})}var V=s;try{"default"in s&&(V=s.default)}catch(e){}var T={};Object.defineProperty(T,"__esModule",{value:true});T.getInclusionReasons=getInclusionReasons$1;var j=V;var O=b;var _=c;function getInclusionReasons$1(e,r,t){const n=t[e]||{};return Object.keys(r).reduce(((e,t)=>{const s=(0,_.getLowestImplementedVersion)(n,t);const o=r[t];if(s){const r=(0,_.isUnreleasedVersion)(s,t);const n=(0,_.isUnreleasedVersion)(o,t);n||!r&&!j.lt(o.toString(),(0,_.semverify)(s))||(e[t]=(0,O.prettifyVersion)(o))}else e[t]=(0,O.prettifyVersion)(o);return e}),{})}var L=s;try{"default"in s&&(L=s.default)}catch(e){}var $=o;try{"default"in o&&($=o.default)}catch(e){}var U={};Object.defineProperty(U,"__esModule",{value:true});U.default=filterItems$1;U.isRequired=isRequired$1;U.targetsSupported=targetsSupported;var M=L;var P=$;var I=c;function targetsSupported(e,r){const t=Object.keys(e);if(t.length===0)return false;const n=t.filter((t=>{const n=(0,I.getLowestImplementedVersion)(r,t);if(!n)return true;const s=e[t];if((0,I.isUnreleasedVersion)(s,t))return false;if((0,I.isUnreleasedVersion)(n,t))return true;if(!M.valid(s.toString()))throw new Error(`Invalid version passed for target "${t}": "${s}". Versions must be in semver format (major.minor.patch)`);return M.gt((0,I.semverify)(n),s.toString())}));return n.length===0}function isRequired$1(e,r,{compatData:t=P,includes:n,excludes:s}={}){return(s==null||!s.has(e))&&(!(n==null||!n.has(e))||!targetsSupported(r,t[e]))}function filterItems$1(e,r,t,n,s,o,a){const i=new Set;const l={compatData:e,includes:r,excludes:t};for(const r in e)if(isRequired$1(r,n,l))i.add(r);else if(a){const e=a.get(r);e&&i.add(e)}s==null||s.forEach((e=>!t.has(e)&&i.add(e)));o==null||o.forEach((e=>!r.has(e)&&i.delete(e)));return i}var R=e;try{"default"in e&&(R=e.default)}catch(e){}var N=r;try{"default"in r&&(N=r.default)}catch(e){}var S=t;try{"default"in t&&(S=t.default)}catch(e){}var k=n;try{"default"in n&&(k=n.default)}catch(e){}var x={};var B=a;Object.defineProperty(x,"__esModule",{value:true});Object.defineProperty(x,"TargetNames",{enumerable:true,get:function(){return W.TargetNames}});x.default=getTargets;Object.defineProperty(x,"filterItems",{enumerable:true,get:function(){return z.default}});Object.defineProperty(x,"getInclusionReasons",{enumerable:true,get:function(){return F.getInclusionReasons}});x.isBrowsersQueryValid=isBrowsersQueryValid;Object.defineProperty(x,"isRequired",{enumerable:true,get:function(){return z.isRequired}});Object.defineProperty(x,"prettifyTargets",{enumerable:true,get:function(){return A.prettifyTargets}});Object.defineProperty(x,"unreleasedLabels",{enumerable:true,get:function(){return H.unreleasedLabels}});var q=R;var E=N;var C=S;var D=k;var Q=c;var H=i;var W=p;var A=b;var F=T;var z=U;const G=C["es6.module"];const J=new E.OptionValidator("@babel/helper-compilation-targets");function validateTargetNames(e){const r=Object.keys(W.TargetNames);for(const t of Object.keys(e))if(!(t in W.TargetNames))throw new Error(J.formatMessage(`'${t}' is not a valid target\n- Did you mean '${(0,E.findSuggestion)(t,r)}'?`));return e}function isBrowsersQueryValid(e){return typeof e==="string"||Array.isArray(e)&&e.every((e=>typeof e==="string"))}function validateBrowsers(e){J.invariant(e===void 0||isBrowsersQueryValid(e),`'${String(e)}' is not a valid browserslist query`);return e}function getLowestVersions(e){return e.reduce(((e,r)=>{const[t,n]=r.split(" ");const s=H.browserNameMap[t];if(!s)return e;try{const r=n.split("-")[0].toLowerCase();const t=(0,Q.isUnreleasedVersion)(r,s);if(!e[s]){e[s]=t?r:(0,Q.semverify)(r);return e}const o=e[s];const a=(0,Q.isUnreleasedVersion)(o,s);if(a&&t)e[s]=(0,Q.getLowestUnreleased)(o,r,s);else if(a)e[s]=(0,Q.semverify)(r);else if(!a&&!t){const t=(0,Q.semverify)(r);e[s]=(0,Q.semverMin)(o,t)}}catch(e){}return e}),{})}function outputDecimalWarning(e){if(e.length){console.warn("Warning, the following targets are using a decimal version:\n");e.forEach((({target:e,value:r})=>console.warn(`  ${e}: ${r}`)));console.warn("\nWe recommend using a string for minor/patch versions to avoid numbers like 6.10\ngetting parsed as 6.1, which can lead to unexpected behavior.\n")}}function semverifyTarget(e,r){try{return(0,Q.semverify)(r)}catch(t){throw new Error(J.formatMessage(`'${r}' is not a valid value for 'targets.${e}'.`))}}function nodeTargetParser(e){const r=e===true||e==="current"?B.versions.node:semverifyTarget("node",e);return["node",r]}function defaultTargetParser(e,r){const t=(0,Q.isUnreleasedVersion)(r,e)?r.toLowerCase():semverifyTarget(e,r);return[e,t]}function generateTargets(e){const r=Object.assign({},e);delete r.esmodules;delete r.browsers;return r}function resolveTargets(e,r){const t=q(e,{mobileToDesktop:true,env:r});return getLowestVersions(t)}const K=new D({max:64});function resolveTargetsCached(e,r){const t=typeof e==="string"?e:e.join()+r;let n=K.get(t);if(!n){n=resolveTargets(e,r);K.set(t,n)}return Object.assign({},n)}function getTargets(e={},r={}){var t,n;let{browsers:s,esmodules:o}=e;const{configPath:a="."}=r;validateBrowsers(s);const i=generateTargets(e);let l=validateTargetNames(i);const u=!!s;const c=u||Object.keys(l).length>0;const d=!r.ignoreBrowserslistConfig&&!c;if(!s&&d){s=q.loadConfig({config:r.configFile,path:a,env:r.browserslistEnv});s==null&&(s=[])}if(o&&(o!=="intersect"||!((t=s)!=null&&t.length))){s=Object.keys(G).map((e=>`${e} >= ${G[e]}`)).join(", ");o=false}if((n=s)!=null&&n.length){const e=resolveTargetsCached(s,r.browserslistEnv);if(o==="intersect")for(const r of Object.keys(e))if(r!=="deno"&&r!=="ie"){const t=G[r==="opera_mobile"?"op_mob":r];if(t){const n=e[r];e[r]=(0,Q.getHighestUnreleased)(n,(0,Q.semverify)(t),r)}else delete e[r]}else delete e[r];l=Object.assign(e,l)}const f={};const g=[];for(const e of Object.keys(l).sort()){const r=l[e];typeof r==="number"&&r%1!==0&&g.push({target:e,value:r});const[t,n]=e==="node"?nodeTargetParser(r):defaultTargetParser(e,r);n&&(f[t]=n)}outputDecimalWarning(g);return f}const X=x.__esModule,Y=x.TargetNames,Z=x.filterItems,ee=x.getInclusionReasons,re=x.isRequired,te=x.prettifyTargets,ne=x.unreleasedLabels;const se=x.isBrowsersQueryValid;export{Y as TargetNames,X as __esModule,x as default,Z as filterItems,ee as getInclusionReasons,se as isBrowsersQueryValid,re as isRequired,te as prettifyTargets,ne as unreleasedLabels};

